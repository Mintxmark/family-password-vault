<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Password Vault</title>
    <script src="https://alcdn.msauth.net/browser/2.13.1/js/msal-browser.min.js"></script>
</head>
<body>
    <h1>Family Password Vault</h1>

    <div id="login-section">
        <button id="login-btn">Login with Microsoft Account</button>
    </div>

    <div id="vault-section" style="display:none;">
        <h2>Manage Your Secrets</h2>
        <form autocomplete="off">
            <div>
                <input type="text" id="secret-name" name="secret-name" placeholder="Secret Name" autocomplete="off">
                <input type="text" id="secret-value" name="secret-value" placeholder="Secret Value" autocomplete="off">
                <button id="add-secret-btn">Add Secret</button>
            </div>
        </form>
        <h3>Your Secrets:</h3>
        <ul id="secrets-list"></ul>
        <button id="logout-btn">Logout</button>
    </div>

    <script>
        const msalConfig = {
            auth: {
                clientId: "<Your Azure AD Client ID>", // Replace with your Azure AD Application ID
                authority: "https://login.microsoftonline.com/<Your Tenant ID>", // Replace with your Azure Tenant ID
                redirectUri: window.location.origin
            }
        };
        const msalInstance = new msal.PublicClientApplication(msalConfig);

        // Trigger Azure AD login
        document.getElementById('login-btn').addEventListener('click', function() {
            login();
        });

        function login() {
            msalInstance.loginPopup().then(response => {
                console.log(response); // View the token response in the console for debugging
                // After successful login, hide login and show vault section
                document.getElementById('login-section').style.display = 'none';
                document.getElementById('vault-section').style.display = 'block';
            }).catch(error => {
                console.error(error);
            });
        }

        // Disable autocomplete, spellcheck, etc. for all input fields programmatically
        document.querySelectorAll('input').forEach(input => {
            input.setAttribute('autocomplete', 'off');
            input.setAttribute('autocorrect', 'off');
            input.setAttribute('autocapitalize', 'off');
            input.setAttribute('spellcheck', 'false');
        });

        document.getElementById('add-secret-btn').addEventListener('click', function() {
            const secretName = document.getElementById('secret-name').value;
            const secretValue = document.getElementById('secret-value').value;
            if (secretName && secretValue) {
                addSecret(secretName, secretValue);
            }
        });

        function addSecret(name, value) {
            // This will later make a call to Azure Functions to store the secret in Azure Key Vault
            alert(`Secret "${name}" added!`);
            const list = document.getElementById('secrets-list');
            const li = document.createElement('li');
            li.textContent = `${name}: ${value}`;
            list.appendChild(li);
        }
    </script>
</body>
</html>
